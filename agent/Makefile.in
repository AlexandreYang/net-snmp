#
# Makefile for snmpd
#
SHELL = /bin/sh
srcdir = @srcdir@
VPATH = @srcdir@
@SET_MAKE@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = $(exec_prefix)/bin
libdir = $(exec_prefix)/lib
etcdir = $(exec_prefix)/etc
snmplibdir = $(prefix)/lib/snmp

INSTALL = @INSTALL@

TARG=	 snmpd
USELIBS= ../snmplib/libsnmp.a
LIBS=	 $(USELIBS) @LIBS@
LDFLAGS= @LDFLAGS@ 
OSFLAGS=

CFLAGS=@CFLAGS@
CPPFLAGS=@CPPFLAGS@ -I.. -I$(srcdir)/.. -I$(srcdir)/../snmplib \
	-I$(srcdir) -I. -I$(srcdir)/mibgroup -Imibgroup

CCHACK = @CC@
CC = @CC@ $(CPPFLAGS)

MIBOBJS=@mibgroup_list_o@

all: subdirs snmpd

subdirs:
	cd mibgroup; $(MAKE)

getkstat: getkstat.o
	$(CC) $(CFLAGS) -o $@ $? $(LIBS)

getkstat.o: kernel_sunos5.c
	$(CC) $(CFLAGS) -o $@ -D_GETKSTAT_TEST -DKDEBUG -c $? 

getmibstat: getmibstat.o
	$(CC) $(CFLAGS) -o $@ $? $(LIBS)

getmibstat.o: kernel_sunos5.c
	$(CC) $(CFLAGS) -o $@ -D_GETMIBSTAT_TEST -DKDEBUG -c $? 

snmpd:	snmpd.o kernel.o snmp_agent.o snmp_vars.o snmp_var_route.o party_vars.o context_vars.o acl_vars.o view_vars.o view_parse.o alarm.o event.o route_write.o kernel_sunos5.o ${MIBOBJS} ../snmplib/libsnmp.a
	${CC} -o $@ snmpd.o kernel.o snmp_agent.o snmp_vars.o snmp_var_route.o party_vars.o context_vars.o acl_vars.o view_vars.o view_parse.o alarm.o event.o route_write.o  kernel_sunos5.o ${MIBOBJS} ${LDFLAGS} ${LIBS}  

clean:
	rm -f *.o ${TARG}
	cd mibgroup; make clean

install:  installdirs
	@$(INSTALL) $(TARG) $(etcdir) ; echo "install:  installed $(TARG) in $(etcdir) "

installdirs:
	@$(SHELL) $(srcdir)/../mkinstalldirs $(etcdir) $(snmplibdir) 

depend: 
	cd mibgroup; $(MAKE) depend; cd ..
	makedepend -I.. -I../snmplib *.c
	perl -n -i.bak -e ' if (/^# DO NOT DELETE THIS LINE/) {$$doit=1;} if ($$doit == 1) {s#/usr/include/[^\s]+##g ; print if (! /^\w+\.o:\s*$$/);} else {print;}' Makefile

# DO NOT DELETE THIS LINE -- make depend depends on it.

acl_vars.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
acl_vars.o:  ../snmplib/asn1.h ../snmplib/snmp.h
acl_vars.o: ../snmplib/snmp_impl.h  snmp_vars.h
acl_vars.o: ../snmplib/party.h mibgroup/snmpv2_vars.h ../snmplib/acl.h
alarm.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
alarm.o: ../snmplib/asn1.h ../snmplib/snmp_impl.h ../snmplib/snmp_api.h
alarm.o: ../snmplib/snmp_client.h ../snmplib/party.h ../snmplib/context.h
alarm.o: snmp_vars.h ../snmplib/snmp.h m2m.h snmp_vars_m2m.h event.h alarm.h
alarm.o: ../snmplib/system.h snmpd.h
context_vars.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
context_vars.o:  ../snmplib/asn1.h ../snmplib/snmp.h
context_vars.o: ../snmplib/snmp_impl.h  snmp_vars.h
context_vars.o: ../snmplib/system.h ../snmplib/context.h ../snmplib/acl.h
context_vars.o: ../snmplib/view.h mibgroup/snmpv2_vars.h
event.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
event.o:   ../snmplib/asn1.h
event.o: ../snmplib/snmp_impl.h ../snmplib/snmp.h snmp_vars.h m2m.h
event.o: snmp_vars_m2m.h alarm.h event.h ../snmplib/snmp_api.h
event.o: ../snmplib/party.h ../snmplib/snmp_client.h
history.o: ../snmplib/asn1.h history.h
kernel.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
kernel.o: ../snmplib/asn1.h ../snmplib/snmp_impl.h
kernel_sunos5.o: ../config.h ../mib_module_config.h
kernel_sunos5.o: ../agent/mibgroup/struct.h
party_vars.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
party_vars.o:  ../snmplib/asn1.h ../snmplib/snmp.h
party_vars.o: ../snmplib/snmp_impl.h  snmp_vars.h
party_vars.o: ../snmplib/system.h ../snmplib/party.h ../snmplib/acl.h
party_vars.o: ../snmplib/view.h
route_write.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
route_write.o:  ../snmplib/asn1.h ../snmplib/snmp.h
route_write.o: ../snmplib/snmp_impl.h snmp_vars.h mibgroup/ip.h mibgroup/at.h
route_write.o: mibgroup/ip.h
snmp_agent.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
snmp_agent.o:  ../snmplib/asn1.h ../snmplib/snmp_impl.h
snmp_agent.o:  ../snmplib/snmp.h ../snmplib/acl.h
snmp_agent.o: ../snmplib/party.h ../snmplib/context.h ../snmplib/mib.h
snmp_agent.o: mibgroup/snmp.h snmpd.h
snmp_var_route.o: ../config.h ../mib_module_config.h
snmp_var_route.o: ../agent/mibgroup/struct.h 
snmp_var_route.o: ../snmplib/asn1.h ../snmplib/snmp_impl.h
snmp_var_route.o: ../snmplib/snmp_api.h ../snmplib/mib.h ../snmplib/snmp.h
snmp_var_route.o: snmp_vars.h mibgroup/ip.h mibgroup/at.h mibgroup/ip.h
snmp_vars.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
snmp_vars.o: common_header.h 
snmp_vars.o:  ../snmplib/asn1.h ../snmplib/snmp.h
snmp_vars.o: ../snmplib/snmp_impl.h  ../snmplib/mib.h
snmp_vars.o: var_struct.h snmp_vars.h m2m.h snmp_vars_m2m.h snmp_vars.linux.h
snmp_vars.o: alarm.h event.h kernel.h mibgroup/mib_module_includes.h
snmp_vars.o: mibgroup/at.h mibgroup/ip.h mibgroup/interfaces.h
snmp_vars.o: mibgroup/snmp.h mibgroup/tcp.h mibgroup/icmp.h mibgroup/ip.h
snmp_vars.o: mibgroup/at.h mibgroup/system.h var_struct.h mibgroup/udp.h
snmp_vars.o: mibgroup/proc.h mibgroup/mibdefs.h mibgroup/versioninfo.h
snmp_vars.o: mibgroup/pass.h mibgroup/disk.h mibgroup/loadave.h
snmp_vars.o: mibgroup/extensible.h mibgroup/util_funcs.h
snmp_vars.o: mibgroup/read_config.h mibgroup/errormib.h ../snmplib/party.h
snmp_vars.o: ../snmplib/context.h ../snmplib/acl.h ../snmplib/view.h snmpd.h
snmp_vars.o: mibgroup/mib_module_inits.h mibgroup/snmpv2_vars.h
snmp_vars.o: mibgroup/mib_module_loads.h mibgroup/snmpv2_subtrees.h
snmpd.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
snmpd.o:  ../snmplib/asn1.h ../snmplib/snmp_impl.h
snmpd.o: ../snmplib/system.h ../snmplib/snmp_api.h ../snmplib/snmp.h m2m.h
snmpd.o: ../snmplib/party.h alarm.h event.h ../snmplib/view.h
snmpd.o: ../snmplib/context.h ../snmplib/acl.h ../snmplib/mib.h
snmpd.o: mibgroup/snmp.h ../snmplib/snmp_client.h snmpd.h
view_parse.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
view_parse.o:  ../snmplib/asn1.h ../snmplib/mib.h
view_parse.o: ../snmplib/view.h
view_vars.o: ../config.h ../mib_module_config.h ../agent/mibgroup/struct.h
view_vars.o:  ../snmplib/asn1.h ../snmplib/snmp.h
view_vars.o: ../snmplib/snmp_impl.h  snmp_vars.h
view_vars.o: ../snmplib/view.h mibgroup/snmpv2_vars.h
